{% extends "base_generic.html" %}

{% block title %}
{% if mode == "received" %}
<title>Follow Requests</title>
{% else %}
<title>Sent Requests</title>
{% endif %}


{% endblock %}

{% load static %}

{% block css %}<link rel="stylesheet" type="text/css" href="{% static 'app/following.css' %}">{% endblock %}

{% block content %}

    <div class="container-fluid d-flex align-items-center flex-column p-3">
        {% if mode == "received" %}
      <h1>{{requests|length}} Follow Request{{requests|pluralize}}</h1>
        {% else %}
        <h1>{{requests|length}} Sent Request{{requests|pluralize}}</h1>
        {% endif %}

{% for request in requests %}

<div class="card mb-3" style="max-width: 540px;">
  <div class="row g-0">
    <div class="col-md-4">
      <img src="{{request.profileImage}}" class="img-fluid" alt="...">
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h5 class="card-title">{{request.displayName}}</h5>
        <p class="card-subtitle mb-2 text-muted">@{{request.username}}</p>
        <p class="card-text">Just coding...</p>    

<div class="btn-group" role="group" aria-label="Basic example">

    <a type="button" class="btn btn-primary" href="{% url 'profile' username=request.username %}" target="_blank"><i class="bi bi-person-fill">&nbsp;Profile</i></a>
        <a type="button" href="{{request.github}}" target="_blank" class="btn btn-secondary"><i class="bi bi-github">&nbsp;GitHub</i></a>

           
</div>
{% if mode == "received" %}
 <form class="mt-3" action="{% url 'requests' author_id=user.username|convert_username_to_id %}" method="post">
                {% csrf_token %}
                
                   <button type="submit" name="action" value="accept_{{request.username}}" data-username="{{request.username}}" class="btn btn-success"><i class="bi bi-check">&nbsp;Accept</i></button>

                          <button type="submit" name="action" value="decline_{{request.username}}" data-username="{{request.username}}" class="btn btn-danger"><i class="bi bi-x">&nbsp;Decline</i></button>

            </form>
{% else %}


 <form class="mt-3" action="{% url 'sent_requests' author_id=user.username|convert_username_to_id %}" method="post">
                {% csrf_token %}
                
                   <button type="submit" name="action" value="cancel_{{request.username}}" data-username="{{request.username}}" class="btn btn-warning"><i class="bi bi-arrow-counterclockwise">&nbsp;Cancel Request</i></button>
            </form>



{% endif %}


      </div>

   <div class="card-footer"><a href="{{request.host}}" class="text-decoration-none">{{request.host|cut:'http://'}}</a></div>


    </div>
  </div>
</div>


{% endfor %}

</div>


{% endblock %}